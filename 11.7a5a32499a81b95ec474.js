(()=>{"use strict";const j=["\uacf5\uaca9\ub825 \uac10\uc18c","\uacf5\uaca9\uc18d\ub3c4 \uac10\uc18c","\ubc29\uc5b4\ub825 \uac10\uc18c","\uc774\ub3d9\uc18d\ub3c4 \uac10\uc18c"];function m(t,e){const n=Object.assign({},t);return Object.entries(e).forEach(([i,o])=>{n[i]||(n[i]=0),n[i]+=o}),n}function E(t,e,n,i,o,f){function l(r){return!!f.hasBuyPrice&&!r.buyPrice||r.tradeLeft<f.tradeLeft}return function p(r,c,u,b,g){if(function(r){return j.find(c=>{var u;return r[c]>=5*Math.floor((null!==(u=n[c])&&void 0!==u?u:0)/5+1)})}(r)||c>o)return[];if(g===e.length)return function(r){return Object.keys(f.effects).find(c=>r[c]<f.effects[c])}(r)?[]:[{effects:r,price:c,items:b}];const O=[],$=t[g],F=e[g];for(const h of $)u[h.name]||l(h)||O.push(...p(m(r,h.effects),c+h.price,Object.assign(Object.assign({},u),{[h.name]:!0}),Object.assign(Object.assign({},b),{[F]:h}),g+1));return O}(Object.values(i).reduce((r,c)=>m(r,c.effects),n),0,Object.fromEntries(Object.values(i).map(r=>[r.name,!0])),i,0)}function y(t){return JSON.stringify(Object.values(t.items).sort((e,n)=>e.name.localeCompare(n.name)))}addEventListener("message",({data:t})=>{const e=function(t,e,n,i,o){const f=function(t){const e=[],n=(i,o=[])=>{if(0===i.length)e.push(o);else for(let f=0;f<i.length;f++){let s=i.slice(),l=s.splice(f,1);n(s.slice(),o.concat(l))}};return n(t),e}(["\ubaa9\uac78\uc774","\uadc0\uac78\uc7741","\uadc0\uac78\uc7742","\ubc18\uc9c01","\ubc18\uc9c02"].filter(l=>!i[l]));let s=[];for(const l of t)for(const a of f){const p=[];for(let r=0;r<a.length;r+=1){const c=a[r],u=Object.entries(l[r]),b=n[`${u[0][0]}_${u[0][1]}_${u[1][0]}_${u[1][1]}_${c}`];b.length>0&&p.push(b)}if(p.length===a.length){s.push(...E(p,a,e,i,s.length?s[s.length-1].price:1/0,o));const r={};s.forEach(c=>{r[y(c)]=c}),s=Object.values(r),s.sort((c,u)=>c.price-u.price),s=s.slice(0,300)}}return s}(t.combinations,t.initialEffect,t.searchResult,t.fixedItems,t.filter);postMessage(e)})})();