(()=>{"use strict";const j=["\uacf5\uaca9\ub825 \uac10\uc18c","\uacf5\uaca9\uc18d\ub3c4 \uac10\uc18c","\ubc29\uc5b4\ub825 \uac10\uc18c","\uc774\ub3d9\uc18d\ub3c4 \uac10\uc18c"];function g(t,e){const n=Object.assign({},t);return Object.entries(e).forEach(([r,o])=>{n[r]||(n[r]=0),n[r]+=o}),n}function E(t,e,n,r,o,f){function l(c){return!!f.hasBuyPrice&&!c.buyPrice}return function p(c,i,u,b,O){if(function(c){return j.find(i=>{var u;return c[i]>=5*Math.floor((null!==(u=n[i])&&void 0!==u?u:0)/5+1)})}(c)||i>o)return[];if(O===e.length)return function(c){return Object.keys(f.effects).find(i=>c[i]<f.effects[i])}(c)?[]:[{effects:c,price:i,items:b}];const m=[],$=t[O],P=e[O];for(const h of $)u[h.name]||l(h)||m.push(...p(g(c,h.effects),i+h.price,Object.assign(Object.assign({},u),{[h.name]:!0}),Object.assign(Object.assign({},b),{[P]:h}),O+1));return m}(Object.values(r).reduce((c,i)=>g(c,i.effects),n),0,Object.fromEntries(Object.values(r).map(c=>[c.name,!0])),r,0)}function y(t){return JSON.stringify(Object.values(t.items).sort((e,n)=>e.name.localeCompare(n.name)))}addEventListener("message",({data:t})=>{const e=function(t,e,n,r,o){const f=function(t){const e=[],n=(r,o=[])=>{if(0===r.length)e.push(o);else for(let f=0;f<r.length;f++){let s=r.slice(),l=s.splice(f,1);n(s.slice(),o.concat(l))}};return n(t),e}(["\ubaa9\uac78\uc774","\uadc0\uac78\uc7741","\uadc0\uac78\uc7742","\ubc18\uc9c01","\ubc18\uc9c02"].filter(l=>!r[l]));let s=[];for(const l of t)for(const a of f){const p=[];for(let c=0;c<a.length;c+=1){const i=a[c],u=Object.entries(l[c]),b=n[`${u[0][0]}_${u[0][1]}_${u[1][0]}_${u[1][1]}_${i}`];b.length>0&&p.push(b)}if(p.length===a.length){s.push(...E(p,a,e,r,s.length?s[s.length-1].price:1/0,o));const c={};s.forEach(i=>{c[y(i)]=i}),s=Object.values(c),s.sort((i,u)=>i.price-u.price),s=s.slice(0,300)}}return s}(t.combinations,t.initialEffect,t.searchResult,t.fixedItems,t.filter);postMessage(e)})})();